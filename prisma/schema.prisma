// // // prisma/schema.prisma

// // generator client {
// //   provider = "prisma-client-js"
// // }

// // datasource db {
// //   provider = "postgresql"
// //   url      = env("DATABASE_URL")
// // }

// // // --- 1. COURSES MODULE ---
// // model Course {
// //   id          String   @id @default(cuid())
// //   title       String
// //   description String?

// //   startDate   DateTime?
// //   endDate     DateTime?

// //   progress         Float   @default(0)
// //   totalModules     Int     @default(0)
// //   completedModules Int     @default(0)
// //   color            String  @default("bg-blue-500")
// //   icon             String  @default("ðŸ“š")

// //   createdAt   DateTime @default(now())
// //   updatedAt   DateTime @updatedAt

// //   // ðŸ‘‡ ADD THIS LINE BACK!
// //   modules     Module[]  
// // }
// // model Module {
// //   id       String @id @default(uuid())
// //   title    String
// //   status   String @default("pending") // 'pending' | 'in-progress' | 'completed'

// //   courseId String
// //   course   Course @relation(fields: [courseId], references: [id], onDelete: Cascade)

// //   topics   Topic[]
// // }

// // model Topic {
// //   id           String  @id @default(uuid())
// //   title        String
// //   duration     String  @default("15 min")
// //   isCompleted  Boolean @default(false)
// //   isFocus      Boolean @default(false) // "Added to Today"

// //   // Focus Room Data
// //   note         String? @db.Text
// //   resourceUrl  String?
// //   resourceMode String? // 'video' | 'whiteboard' | 'browser'

// //   moduleId     String
// //   module       Module  @relation(fields: [moduleId], references: [id], onDelete: Cascade)
// // }

// // // --- 2. KANBAN (TASKS) ---
// // model TaskColumn {
// //   id    String @id @default(uuid())
// //   title String // "Todo", "In Progress", "Done"
// //   order Int    @default(0)

// //   tasks Task[]
// // }

// // model Task {
// //   id        String   @id @default(uuid())
// //   content   String
// //   priority  String   @default("low") // 'low' | 'medium' | 'high'
// //   order     Int      @default(0)

// //   columnId  String
// //   column    TaskColumn @relation(fields: [columnId], references: [id], onDelete: Cascade)
// // }

// // // --- 3. APPLICATIONS TRACKER ---
// // model JobApplication {
// //   id          String   @id @default(uuid())
// //   company     String
// //   position    String
// //   status      String   // 'Applied' | 'Interview' | 'Offer' | 'Rejected'
// //   salary      String?
// //   location    String?
// //   dateApplied DateTime @default(now())
// // }

// // // --- 4. FLASHCARDS ---
// // model Deck {
// //   id          String   @id @default(uuid())
// //   title       String
// //   description String?
// //   color       String   @default("bg-purple-500")

// //   cards       Flashcard[]
// // }

// // model Flashcard {
// //   id      String @id @default(uuid())
// //   front   String
// //   back    String
// //   mastery String @default("new") // 'new' | 'hard' | 'medium' | 'easy'

// //   deckId  String
// //   deck    Deck   @relation(fields: [deckId], references: [id], onDelete: Cascade)
// // }

// // // --- 5. PLANNER ---
// // model Event {
// //   id        String   @id @default(uuid())
// //   title     String
// //   subtitle  String?
// //   type      String   // 'Class' | 'Study' | 'Test'...
// //   date      String   // YYYY-MM-DD string for filtering
// //   startTime String
// //   isDone    Boolean  @default(false)

// //   createdAt DateTime @default(now())
// // }

// // model Goal {
// //   id        String   @id @default(uuid())
// //   title     String   // e.g., "Solve 50 Problems"
// //   type      String   // 'weekly' | 'monthly'
// //   current   Int      @default(0)
// //   target    Int
// //   isDone    Boolean  @default(false)

// //   createdAt DateTime @default(now())
// // }

// // model ScheduleEvent {
// //   id        String   @id @default(cuid())
// //   title     String
// //   subtitle  String?
// //   startTime String   // Store as "HH:mm"
// //   type      String   // "Class", "Study", "Test", "Break", "Meeting"
// //   date      String   // Store as .toDateString() for easy daily filtering
// //   completed Boolean  @default(false)

// //   createdAt DateTime @default(now())
// //   updatedAt DateTime @updatedAt
// // }

// generator client {
//   provider = "prisma-client-js"
// }

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

// // --- 1. COURSES MODULE ---
// model User {
//   id        String   @id @default(cuid())
//   userId    String
//   clerkId   String   @unique
//   email     String   @unique
//   name      String?
//   imageUrl  String?
//   plan      String   @default("FREE") // "FREE" or "PRO"
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   // Relations
//   courses Course[]
//   goals   Goal[]
//   tasks   Task[]

//   @@index([userId])
// }

// model Course {
//   id               String    @id @default(cuid())
//   userId           String // Required link to User
//   user             User      @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
//   title            String
//   description      String?
//   startDate        DateTime?
//   endDate          DateTime?
//   progress         Float     @default(0)
//   totalModules     Int       @default(0)
//   completedModules Int       @default(0)
//   color            String    @default("bg-blue-500")
//   icon             String    @default("ðŸ“š")
//   createdAt        DateTime  @default(now())
//   updatedAt        DateTime  @updatedAt

//   modules Module[]

//   @@index([userId])
// }

// model Module {
//   id       String  @id @default(uuid())
//   title    String
//   status   String  @default("pending") // 'pending' | 'in-progress' | 'completed'
//   courseId String
//   course   Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)
//   topics   Topic[]
// }

// model Topic {
//   id          String  @id @default(uuid())
//   title       String
//   duration    String  @default("15 min")
//   isCompleted Boolean @default(false)
//   isFocus     Boolean @default(false) // "Added to Today"

//   // Focus Room Data
//   note         String? @db.Text
//   resourceUrl  String?
//   resourceMode String? // 'video' | 'whiteboard' | 'browser'

//   moduleId String
//   module   Module @relation(fields: [moduleId], references: [id], onDelete: Cascade)
// }

// // --- 2. KANBAN (TASKS) ---
// model TaskColumn {
//   id    String @id @default(uuid())
//   title String // "Todo", "In Progress", "Done"
//   order Int    @default(0)
//   tasks Task[]
// }

// model Task {
//   id        String     @id @default(cuid())
//   content   String
//   completed Boolean    @default(false) // ðŸ‘ˆ Add this line
//   priority  String     @default("low")
//   order     Int        @default(0)
//   columnId  String
//   column    TaskColumn @relation(fields: [columnId], references: [id], onDelete: Cascade)
//   createdAt DateTime   @default(now())

//   userId String
//   user   User   @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
// }

// // --- 3. APPLICATIONS TRACKER ---
// model JobApplication {
//   id          String   @id @default(uuid())
//   company     String
//   position    String
//   status      String // 'Applied' | 'Interview' | 'Offer' | 'Rejected'
//   salary      String?
//   location    String?
//   dateApplied DateTime @default(now())
// }

// // --- 4. FLASHCARDS ---
// model Deck {
//   id          String      @id @default(uuid())
//   title       String
//   description String?
//   color       String      @default("bg-purple-500")
//   cards       Flashcard[]
// }

// model Flashcard {
//   id      String @id @default(uuid())
//   front   String
//   back    String
//   mastery String @default("new") // 'new' | 'hard' | 'medium' | 'easy'
//   deckId  String
//   deck    Deck   @relation(fields: [deckId], references: [id], onDelete: Cascade)
// }

// // --- 5. PLANNER ---
// model Event {
//   id        String   @id @default(uuid())
//   title     String
//   subtitle  String?
//   type      String // 'Class' | 'Study' | 'Test'...
//   date      String // YYYY-MM-DD string for filtering
//   startTime String
//   isDone    Boolean  @default(false)
//   createdAt DateTime @default(now())
// }

// // prisma/schema.prisma
// // prisma/schema.prisma
// // prisma/schema.prisma

// model Goal {
//   id    String @id @default(cuid())
//   title String
//   type  String // 'weekly' | 'monthly'

//   // Add these fields to match your server action
//   category String @default("CUSTOM") // 'COURSE' | 'MODULE' | 'SKILL'
//   color    String @default("indigo")

//   targetId String? // Reference to Course/Module ID
//   deadline DateTime?
//   current  Int       @default(0)
//   target   Int
//   isDone   Boolean   @default(false)

//   createdAt DateTime @default(now())

//   userId String
//   user   User   @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
// }

// model ScheduleEvent {
//   id        String   @id @default(cuid())
//   title     String
//   subtitle  String?
//   startTime String // Store as "HH:mm"
//   type      String // "Class", "Study", "Test", "Break", "Meeting"
//   date      String // Store as .toDateString() for easy daily filtering
//   completed Boolean  @default(false)
//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- CORE USER MODEL ---
model User {
  id       String  @id @default(cuid())
  clerkId  String  @unique
  email    String  @unique
  name     String?
  imageUrl String?
  plan     String  @default("FREE")

  streak    Int      @default(0)
  lastLogin DateTime @default(now())

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  activities      Activity[]
  courses         Course[]
  goals           Goal[]
  tasks           Task[]
  jobApplications JobApplication[]
  decks           Deck[]
  events          Event[]
  scheduleEvents  ScheduleEvent[]
}

model Activity {
  id     String   @id @default(cuid())
  date   DateTime @default(now())
  count  Int      @default(1)
  userId String
  user   User     @relation(fields: [userId], references: [clerkId], onDelete: Cascade)

  @@index([userId, date])
}

// --- 1. COURSES MODULE ---
model Course {
  id               String    @id @default(cuid())
  userId           String
  user             User      @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  title            String
  description      String?
  startDate        DateTime?
  endDate          DateTime?
  progress         Float     @default(0)
  totalModules     Int       @default(0)
  completedModules Int       @default(0)
  color            String    @default("bg-blue-500")
  icon             String    @default("ðŸ“š")
  createdAt        DateTime  @default(now())
  lastAccessed     DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  modules          Module[]

  @@index([userId])
}

model Module {
  id       String  @id @default(uuid())
  title    String
  status   String  @default("pending")
  courseId String
  course   Course  @relation(fields: [courseId], references: [id], onDelete: Cascade)
  topics   Topic[]
}

model Topic {
  id          String    @id @default(uuid())
  title       String
  duration    String    @default("15 min")
  isCompleted Boolean   @default(false)
  completedAt DateTime? 
  isFocus      Boolean @default(false)
  note         String? @db.Text
  resourceUrl  String?
  resourceMode String?
  moduleId     String
  module       Module  @relation(fields: [moduleId], references: [id], onDelete: Cascade)
}

// --- 2. KANBAN (TASKS) ---
model TaskColumn {
  id    String @id @default(uuid())
  title String
  order Int    @default(0)
  tasks Task[]
}

model Task {
  id        String     @id @default(cuid())
  content   String
  completed Boolean    @default(false)
  priority  String     @default("low")
  order     Int        @default(0)
  columnId  String
  column    TaskColumn @relation(fields: [columnId], references: [id], onDelete: Cascade)
  createdAt DateTime   @default(now())
  userId    String
  user      User       @relation(fields: [userId], references: [clerkId], onDelete: Cascade)

  @@index([userId])
}

// --- 3. APPLICATIONS TRACKER ---
model JobApplication {
  id          String   @id @default(uuid())
  userId      String
  user        User     @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  company     String
  position    String
  status      String
  salary      String?
  location    String?
  dateApplied DateTime @default(now())

  @@index([userId])
}

// --- 4. FLASHCARDS ---
model Deck {
  id          String      @id @default(uuid())
  userId      String
  user        User        @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  title       String
  description String?
  color       String      @default("bg-purple-500")
  cards       Flashcard[]

  @@index([userId])
}

model Flashcard {
  id      String @id @default(uuid())
  front   String
  back    String
  mastery String @default("new")
  deckId  String
  deck    Deck   @relation(fields: [deckId], references: [id], onDelete: Cascade)
}

// --- 5. PLANNER & EVENTS ---
model Event {
  id        String   @id @default(uuid())
  userId    String
  user      User     @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  title     String
  subtitle  String?
  type      String
  date      String
  startTime String
  isDone    Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([userId])
}

model Goal {
  id        String    @id @default(cuid())
  userId    String
  user      User      @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  title     String
  type      String
  category  String    @default("CUSTOM")
  color     String    @default("indigo")
  targetId  String?
  deadline  DateTime?
  current   Int       @default(0)
  target    Int
  isDone    Boolean   @default(false)
  createdAt DateTime  @default(now())

  @@index([userId])
}

model ScheduleEvent {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [clerkId], onDelete: Cascade)
  title     String
  subtitle  String?
  startTime String
  type      String
  date      String
  completed Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}
